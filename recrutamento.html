
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avaliação - PMERJ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="https://cdn.discordapp.com/attachments/1127720158555807854/1134996805239722106/logotipo.png" type="image/x-icon">
</head>
<body>
    <div class="containerLogin" id="containerLogin">
        <a href="index.html" id="returnHome">Voltar ao Inicio</a>
        <form action="" onsubmit="sendLogin(event)">
            <div class="campusLogin">
                <h1 style="font-size: 2rem;">Fazer Login Recrutamento - PMERJ</h1>
                <div class="question">
                    <span>Usuario</span><br>
                    <input type="text" id="usuario" placeholder="Digite seu Usuario">
                </div>
    
                <div class="question">
                    <span>Senha</span><br>
                    <input type="password" id="senha" placeholder="Senha">
                </div>

                <button type="submit">Fazer Login</button>
            </div>
        </form>
    </div>

    <div class="containerGeneral" id="containerGeneral" style="display: none;">
    <div class="header">
        <div class="group1">
            <img src="https://cdn.discordapp.com/attachments/1127720158555807854/1135035091169595562/logo-pmerj.png" alt="">
            <a href="index.html" id="optionLink">Inicio</a>
            <a href="https://discord.gg/pmerjnexusrj" id="optionLink" class="discord">Discord</a>
            <a href="https://pro5m-bot.com/redirect/nexusrp2/fivem/" id="optionLink" class="connectFiveM" >FiveM</a>
            <a href="administrator.html" id="optionLink" class="admnistrator">Administrador</a>
            <a href="commandUp.html" id="optionLink" class="commandUp">Alto Comando</a>
        </div>

        <div class="group2">
            
            <img src="https://cdn.discordapp.com/attachments/1127720158555807854/1135035091400265748/pesquisa.png" alt="">
            <img src="https://cdn.discordapp.com/attachments/1127720158555807854/1135035091639349408/sino.png" alt="">
            <button id="logoff" onclick="logoff()"><img src="https://cdn.discordapp.com/attachments/1127720158555807854/1135313912762482798/logoff.png" alt=""></button>
            <img src="https://cdn.discordapp.com/attachments/1127720158555807854/1135035991938301962/account.png" alt="">
        
        </div>
        
    </div>
    <div id="questionnaire">
        <form onsubmit="sendContact(event)">
            <h1 style="font-size: 2rem;">Avaliação - PMERJ</h1>
            <div class="question">
                <span>Instrutor</span><br>
                <input type="text" id="instrutor" placeholder="Digite seu Funcional">
            </div>
            <div class="question">
                <span>Nome &amp; Id do conscrito: Exemplo("Luydi Passarin | 1430")</span><br>
                <input type="text" id="conscrito" placeholder="Digite o nome do Conscrito & ID">
            </div>
            <div class="question">
                <span>Turno de Trabalho</span><br>
                <input type="text" id="turno" placeholder="Digite turno disponivel">
            </div>
            <div class="question">
                <span>1) Uma viatura pede apoio para realizar uma abordagem, sua viatura está<br> se deslocando para atender a solicitação de apoio. Como você modularia na Maré Zero?<br> (Instrutor: obrigatório o uso do nosso padrão de modulação, mas, não informe isso ao mesmo) [2.0 ponto]</span><br>
                <input type="text" class="answer" placeholder="Digite entre [0.0 - 2]">
            </div>
            <div class="question">
                <span>2) Sua VTR passa em frente a uma casa onde indivíduos armados ao avistarem a VTR, atiram contra a guarnição. Como você modularia na Maré Zero?<br>
                    (Instrutor: obrigatório o uso do nosso padrão de modulação, mas, não informe isso ao mesmo) [2.0 ponto]</span><br>
                <input type="text" class="answer" placeholder="Digite entre [0.0 - 2]">
            </div>
            <div class="question">
                <span>3) A PM recebe uma denúncia de tráfico de drogas e sua guarnição vai averiguar. Quando vocês chegam ao local da denúncia, se deparam com um cidadão do<br> sexo oposto ao seu, deixando em uma casa um pacote suspeito. O que você faria nessa situação? [2.0 ponto]</span><br>
                <input type="text" class="answer" placeholder="Digite entre [0.0 - 2]">
            </div>
            <div class="question">
                <span>4) Qual é o procedimento em uma abordagem de rotina? [2.0 ponto]</span><br>
                <input type="text" class="answer" placeholder="Digite entre [0.0 - 2]">
            </div>
            <div class="question">
                <span>5) Qual é o procedimento em uma abordagem suspeita? [2.0 ponto]</span><br>
                <input type="text" class="answer" placeholder="Digite entre [0.0 - 2]">
            </div>
    
            <div class="question">
                <span>Digite sua Observação</span><br>
                <input type="text" id="observacao" placeholder="Digite sua Observação">
            </div>
            <button id="finalizarAvaliar" type="submit">Finalizar Avaliação</button>
        </form>
    </div>
    <script>
        // Função para verificar se o usuário já está logado
        function checkSession() {
            const sessionExists = localStorage.getItem('session');
            
            if (sessionExists) {
            const login = document.getElementById('containerLogin');
            const containerGeneral = document.getElementById('containerGeneral');
            login.style.display = 'none';
            containerGeneral.style.display = 'block';
        }
    }
    
    // Função para fazer o login
    async function sendLogin(ev) {
        ev.preventDefault();
        const login = document.getElementById('containerLogin');
        const containerGeneral = document.getElementById('containerGeneral');
        const usuario = document.getElementById('usuario').value;
        const senha = document.getElementById('senha').value;
        
        const usuarioL = 'Recrutador';
        const senhaL = 'Pmerj@2023';
        
        if (usuario === usuarioL && senha === senhaL) {
            // Login bem-sucedido, armazenar sessão no localStorage
            localStorage.setItem('session', 'true');
            login.style.display = 'none';
            containerGeneral.style.display = 'block';
        } else {
            alert('Usuário ou senha incorretos. Tente novamente.');
        }
    }
    
    // Função para fazer logoff
    function logoff() {
        localStorage.removeItem('session');
        const login = document.getElementById('containerLogin');
        const containerGeneral = document.getElementById('containerGeneral');
        login.style.display = 'flex';
        containerGeneral.style.display = 'none';
    }
    
    
    // Ao carregar a página, verifica se já existe uma sessão e mostra o conteúdo correto
    window.onload = checkSession;
    
    
    async function sendContact(ev) {
        ev.preventDefault();
        var instrutor = document.getElementById('instrutor').value;
        var conscrito = document.getElementById("conscrito").value;
        var turno = document.getElementById("turno").value;
        var obs = document.getElementById("observacao").value;
        const answerElements = document.getElementsByClassName("answer");
        var sum = 0;
        for (let i = 0; i < answerElements.length; i++) {
            const answer = parseFloat(answerElements[i].value);
            if (!isNaN(answer)) {
                sum += answer;
            }
        }
        if (sum < 7){
            var webhookBody = {
                content: `**Avaliação de Recrutamento - PMERJ**
Instrutor: ${instrutor}
Conscrito: ${conscrito}
Turno de trabalho: ${turno}
                
Questão 1: ${answerElements[0].value}
Questão 2: ${answerElements[1].value}
Questão 3: ${answerElements[2].value}
Questão 4: ${answerElements[3].value}
Questão 5: ${answerElements[4].value}
                
Pontuação total: ${sum.toFixed(1)}
Observações: ${obs}
Resultado: **Reprovado**`
            };
        }else{
            var webhookBody = {
                content: `**Avaliação de Recrutamento - PMERJ**
Instrutor: ${instrutor}
Conscrito: ${conscrito}
Turno de trabalho: ${turno}
                
Questão 1: ${answerElements[0].value}
Questão 2: ${answerElements[1].value}
Questão 3: ${answerElements[2].value}
Questão 4: ${answerElements[3].value}
Questão 5: ${answerElements[4].value}
                
Pontuação total: ${sum.toFixed(1)}
Observações: ${obs}
                
Resultado: **Aprovado**`
            };
        }
        const webhookUrl = 'https://discord.com/api/webhooks/1135308141404364881/ttqoZuJwn7GOaMCN9Sa3p5pBf5WAfgPC2Me0_gpEroOFuYHFak5C_1dikKePezDIzroF';
        const response = await fetch(webhookUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(webhookBody),
        });
        if (response.ok) {
            alert('Parabéns, você enviou sua prova');
        } else {
            alert('There was an error! Try again later!');
        }
    }
    </script>
    </div>
    <!-- <script>
        function finalizar() {
            var conscrito = document.getElementById("conscrito").value;
            var turno = document.getElementById("turno").value;
            var obs = document.getElementById("observacao").value;
            const answerElements = document.getElementsByClassName("answer");
            let sum = 0;
            for (let i = 0; i < answerElements.length; i++) {
                const answer = parseFloat(answerElements[i].value);
                if (!isNaN(answer)) {
                    sum += answer;
                }
            }
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = `
                <p>Conscrito: ${conscrito}<br>Turno de trabalho: ${turno}</p>
                <p>Questão 1: ${answerElements[0].value} <br> Questão 2: ${answerElements[1].value} <br> Questão 3: ${answerElements[2].value} <br> Questão 4: ${answerElements[3].value} <br> Questão 5: ${answerElements[4].value}</p>
                <p>Pontuação total: ${sum.toFixed(1)}</p>
                <p>Observações: ${obs}</p>
            `;
        }
    </script> -->
</body>
</html>
